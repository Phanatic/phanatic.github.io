<!DOCTYPE html>
<html>
  <head>
    <title>Working with Inheritance in Ado.net Data Services – Phani Raj – Technical Lead at HP Cloud</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="I’ve seen this question quite often on the Astoria forums and wanted to write something down so that our users can gain from the discussions that go on in our forums.    We will discuss how one deals with entities ( tables / records / resources ) that participate in an inheritance hierarchy.     We shall take the following Data Model to discuss some key scenarios involving the Client Library. 
//Base Class
[DataServiceKey(&quot;PersonID&quot;)]
public class Person {
        public int PersonID { get; set; }
        public string Name { get; set; }
    }

//Derived Class
public class Employee : Person {
        public int EmployeeID { get; set; }
}
And you expose an IQueryable&lt;Person&gt; from your data source,
public class InheritedProvider {
        static List&lt;Person&gt; _people;
        private static void Initialize()  {
            _people = new List&lt;Person&gt;(){
                new Person  {
                    PersonID =1,
                    Name=&quot;Phani&quot;
                },
                new Employee {
                    PersonID =2,
                    EmployeeID =3,
                    Name =&quot;Raj&quot;
                }
            };
        }
        public IQueryable&lt;Person&gt; People {
            get {
                if (_people == null)
                    Initialize();
                return _people.AsQueryable&lt;Person&gt;();
            }
        }
    }
Browsing to the /People endpoint of the service gives you : 

  &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;yes&quot; ?&gt;
&lt;feed …Namespace Declarations… &gt;
&#160; &lt;title type=&quot;text&quot;&gt;People&lt;/title&gt;
&#160; &lt;id&gt;http://localhost:13975/Inheritance.svc/People&lt;/id&gt;
&#160; &lt;updated&gt;2008-12-23T20:56:47Z&lt;/updated&gt;
&#160; &lt;link rel=&quot;self&quot; title=&quot;People&quot; href=&quot;People&quot; /&gt;
&#160; &lt;entry&gt;
&#160; &lt;id&gt;http://localhost:13975/Inheritance.svc/People(1)&lt;/id&gt;
&#160; &lt;title type=&quot;text&quot; /&gt;
&#160; &lt;updated&gt;2008-12-23T20:56:47Z&lt;/updated&gt;
&#160; &lt;author&gt;
&#160; &lt;name /&gt;
&#160; &lt;/author&gt;
&#160; &lt;link rel=&quot;edit&quot; title=&quot;Person&quot; href=&quot;People(1)&quot; /&gt;&#160;&#160; 
&lt;category term=&quot;Repro.Person&quot; scheme=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices/scheme&quot; /&gt; 
&lt;content type=&quot;application/xml&quot;&gt;
  &#160; &lt;m:properties&gt;
&#160; &lt;d:PersonID m:type=&quot;Edm.Int32&quot;&gt;1&lt;/d:PersonID&gt;
&#160; &lt;d:Name&gt;Phani&lt;/d:Name&gt;
&#160; &lt;/m:properties&gt;
&#160; &lt;/content&gt;
&#160; &lt;/entry&gt;
&#160; &lt;entry&gt;
&#160; &lt;id&gt;http://localhost:13975/Inheritance.svc/People(2)&lt;/id&gt;
&#160; &lt;title type=&quot;text&quot; /&gt;
&#160; &lt;updated&gt;2008-12-23T20:56:47Z&lt;/updated&gt;
&#160; &lt;author&gt;
&#160; &lt;name /&gt;
&#160; &lt;/author&gt;
&#160; &lt;link rel=&quot;edit&quot; title=&quot;Person&quot; href=&quot;People(2)&quot; /&gt;&#160; 
&lt;category term=&quot;Repro.Employee&quot; scheme=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices/scheme&quot; /&gt;
&#160; &lt;content type=&quot;application/xml&quot;&gt;
  &#160; &lt;m:properties&gt;
&#160; &lt;d:PersonID m:type=&quot;Edm.Int32&quot;&gt;2&lt;/d:PersonID&gt;
&#160; &lt;d:Name&gt;Raj&lt;/d:Name&gt;
&#160; &lt;d:EmployeeID m:type=&quot;Edm.Int32&quot;&gt;3&lt;/d:EmployeeID&gt;
&#160; &lt;/m:properties&gt;
&#160; &lt;/content&gt;
&#160; &lt;/entry&gt;
&#160; &lt;/feed&gt; 
As you can see , the &lt;Category&gt; element of an &lt;entry&gt; element represents the Entity Type that this &lt;entry&gt; represents.
  
How does this help one with working with against an Entity Set using Inheritance ?
Consider the following snippet of Client Code :
DataServiceContext dsc = new DataServiceContext(new Uri(&quot;URI_TO_DATASERVICE&quot;));
Employee newEmployee = new Employee() {Name = &quot;Peter Qian&quot;};
dsc.AddObject(&quot;People&quot;, newEmployee);
dsc.SaveChanges();
Can you guess what is wrong with this ?
Yep, since the client library sees that you are trying to insert a Person Entity , we put the Entity Type as “Person”
in the payload , i.e , the above operation results in the payload :
&lt;entry xmlns:d=http://schemas.microsoft.com/ado/2007/08/dataservices        xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata        xmlns=&quot;http://www.w3.org/2005/Atom&quot;&gt;
&lt;updated&gt;2008-12-23T21:23:38.5935141Z&lt;/updated&gt;
&lt;content type=&quot;application/xml&quot;&gt;
   &lt;m:properties&gt;
     &lt;d:EmployeeID m:type=&quot;Edm.Int32&quot;&gt;0&lt;/d:EmployeeID&gt;
     &lt;d:Name&gt;Peter Qian&lt;/d:Name&gt;
     &lt;d:PersonID m:type=&quot;Edm.Int32&quot;&gt;0&lt;/d:PersonID&gt;
   &lt;/m:properties&gt;
&lt;/content&gt;
&lt;/entry&gt;

And this causes the Server to respond with :
  
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;error xmlns=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices/metadata&quot;&gt;
  &lt;code&gt;&lt;/code&gt;
  &lt;message xml:lang=&quot;en-US&quot;&gt;Error processing request stream.
    Type information must be specified for types that take part in inheritance.&lt;/message&gt;
&lt;/error&gt;
This error is because , as you can see in the request payload , the &lt;category&gt; element which specifies the Entity Type is missing form the Request Payload.
  Since the Client library doesn’t resolve the Names/Types of the Entities for you , it provides you hooks to customize the name/type resolution
so that the right entity type is specified in the payloads.
Why can’t the Client library do this automatically ?
Main reason , Since we allow POCO , the type hierarchy of entities on the client can be different compared to the server.
  
In your client code , set the ResolveName and ResolveType Properties on the&#160; DataServiceContext instance to
override the default type resolution behavior.

ex :
DataServiceContext dsc = new DataServiceContext(new Uri(&quot;URI_TO_DATASERVICE&quot;));
dsc.ResolveName = delegate(Type entityType) {
     return entityType.FullName.Replace(&quot;&lt;ClientNamespace&gt;&quot;, &quot;&lt;ServerNamespace&gt;&quot;);
};
dsc.ResolveType = delegate(string entitySetName) {
      return Type.GetType(entitySetName);
};
Employee newEmployee = new Employee() {Name = &quot;Peter Qian&quot;};
dsc.AddObject(&quot;People&quot;, newEmployee);
dsc.SaveChanges();
Since we provide the right Entity Type Name in the ResolveName property , the right Entity Type
is placed in the payload.
&lt;entry xmlns:d=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices&quot;
       xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata       xmlns=&quot;http://www.w3.org/2005/Atom&quot;&gt;
&lt;category scheme=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices/scheme&quot; term=&quot;ServerNamespace.Employee&quot; /&gt;
&lt;updated&gt;2008-12-23T21:52:44.8021175Z&lt;/updated&gt;
&lt;content type=&quot;application/xml&quot;&gt;
    &lt;m:properties&gt;
      &lt;d:EmployeeID m:type=&quot;Edm.Int32&quot;&gt;0&lt;/d:EmployeeID&gt;
      &lt;d:Name&gt;Peter Qian&lt;/d:Name&gt;
      &lt;d:PersonID m:type=&quot;Edm.Int32&quot;&gt;0&lt;/d:PersonID&gt;
    &lt;/m:properties&gt;
  &lt;/content&gt;
&lt;/entry&gt;
Hope this helps .
" />
    <meta property="og:description" content="I’ve seen this question quite often on the Astoria forums and wanted to write something down so that our users can gain from the discussions that go on in our forums.    We will discuss how one deals with entities ( tables / records / resources ) that participate in an inheritance hierarchy.     We shall take the following Data Model to discuss some key scenarios involving the Client Library. 
//Base Class
[DataServiceKey(&quot;PersonID&quot;)]
public class Person {
        public int PersonID { get; set; }
        public string Name { get; set; }
    }

//Derived Class
public class Employee : Person {
        public int EmployeeID { get; set; }
}
And you expose an IQueryable&lt;Person&gt; from your data source,
public class InheritedProvider {
        static List&lt;Person&gt; _people;
        private static void Initialize()  {
            _people = new List&lt;Person&gt;(){
                new Person  {
                    PersonID =1,
                    Name=&quot;Phani&quot;
                },
                new Employee {
                    PersonID =2,
                    EmployeeID =3,
                    Name =&quot;Raj&quot;
                }
            };
        }
        public IQueryable&lt;Person&gt; People {
            get {
                if (_people == null)
                    Initialize();
                return _people.AsQueryable&lt;Person&gt;();
            }
        }
    }
Browsing to the /People endpoint of the service gives you : 

  &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;yes&quot; ?&gt;
&lt;feed …Namespace Declarations… &gt;
&#160; &lt;title type=&quot;text&quot;&gt;People&lt;/title&gt;
&#160; &lt;id&gt;http://localhost:13975/Inheritance.svc/People&lt;/id&gt;
&#160; &lt;updated&gt;2008-12-23T20:56:47Z&lt;/updated&gt;
&#160; &lt;link rel=&quot;self&quot; title=&quot;People&quot; href=&quot;People&quot; /&gt;
&#160; &lt;entry&gt;
&#160; &lt;id&gt;http://localhost:13975/Inheritance.svc/People(1)&lt;/id&gt;
&#160; &lt;title type=&quot;text&quot; /&gt;
&#160; &lt;updated&gt;2008-12-23T20:56:47Z&lt;/updated&gt;
&#160; &lt;author&gt;
&#160; &lt;name /&gt;
&#160; &lt;/author&gt;
&#160; &lt;link rel=&quot;edit&quot; title=&quot;Person&quot; href=&quot;People(1)&quot; /&gt;&#160;&#160; 
&lt;category term=&quot;Repro.Person&quot; scheme=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices/scheme&quot; /&gt; 
&lt;content type=&quot;application/xml&quot;&gt;
  &#160; &lt;m:properties&gt;
&#160; &lt;d:PersonID m:type=&quot;Edm.Int32&quot;&gt;1&lt;/d:PersonID&gt;
&#160; &lt;d:Name&gt;Phani&lt;/d:Name&gt;
&#160; &lt;/m:properties&gt;
&#160; &lt;/content&gt;
&#160; &lt;/entry&gt;
&#160; &lt;entry&gt;
&#160; &lt;id&gt;http://localhost:13975/Inheritance.svc/People(2)&lt;/id&gt;
&#160; &lt;title type=&quot;text&quot; /&gt;
&#160; &lt;updated&gt;2008-12-23T20:56:47Z&lt;/updated&gt;
&#160; &lt;author&gt;
&#160; &lt;name /&gt;
&#160; &lt;/author&gt;
&#160; &lt;link rel=&quot;edit&quot; title=&quot;Person&quot; href=&quot;People(2)&quot; /&gt;&#160; 
&lt;category term=&quot;Repro.Employee&quot; scheme=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices/scheme&quot; /&gt;
&#160; &lt;content type=&quot;application/xml&quot;&gt;
  &#160; &lt;m:properties&gt;
&#160; &lt;d:PersonID m:type=&quot;Edm.Int32&quot;&gt;2&lt;/d:PersonID&gt;
&#160; &lt;d:Name&gt;Raj&lt;/d:Name&gt;
&#160; &lt;d:EmployeeID m:type=&quot;Edm.Int32&quot;&gt;3&lt;/d:EmployeeID&gt;
&#160; &lt;/m:properties&gt;
&#160; &lt;/content&gt;
&#160; &lt;/entry&gt;
&#160; &lt;/feed&gt; 
As you can see , the &lt;Category&gt; element of an &lt;entry&gt; element represents the Entity Type that this &lt;entry&gt; represents.
  
How does this help one with working with against an Entity Set using Inheritance ?
Consider the following snippet of Client Code :
DataServiceContext dsc = new DataServiceContext(new Uri(&quot;URI_TO_DATASERVICE&quot;));
Employee newEmployee = new Employee() {Name = &quot;Peter Qian&quot;};
dsc.AddObject(&quot;People&quot;, newEmployee);
dsc.SaveChanges();
Can you guess what is wrong with this ?
Yep, since the client library sees that you are trying to insert a Person Entity , we put the Entity Type as “Person”
in the payload , i.e , the above operation results in the payload :
&lt;entry xmlns:d=http://schemas.microsoft.com/ado/2007/08/dataservices        xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata        xmlns=&quot;http://www.w3.org/2005/Atom&quot;&gt;
&lt;updated&gt;2008-12-23T21:23:38.5935141Z&lt;/updated&gt;
&lt;content type=&quot;application/xml&quot;&gt;
   &lt;m:properties&gt;
     &lt;d:EmployeeID m:type=&quot;Edm.Int32&quot;&gt;0&lt;/d:EmployeeID&gt;
     &lt;d:Name&gt;Peter Qian&lt;/d:Name&gt;
     &lt;d:PersonID m:type=&quot;Edm.Int32&quot;&gt;0&lt;/d:PersonID&gt;
   &lt;/m:properties&gt;
&lt;/content&gt;
&lt;/entry&gt;

And this causes the Server to respond with :
  
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;error xmlns=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices/metadata&quot;&gt;
  &lt;code&gt;&lt;/code&gt;
  &lt;message xml:lang=&quot;en-US&quot;&gt;Error processing request stream.
    Type information must be specified for types that take part in inheritance.&lt;/message&gt;
&lt;/error&gt;
This error is because , as you can see in the request payload , the &lt;category&gt; element which specifies the Entity Type is missing form the Request Payload.
  Since the Client library doesn’t resolve the Names/Types of the Entities for you , it provides you hooks to customize the name/type resolution
so that the right entity type is specified in the payloads.
Why can’t the Client library do this automatically ?
Main reason , Since we allow POCO , the type hierarchy of entities on the client can be different compared to the server.
  
In your client code , set the ResolveName and ResolveType Properties on the&#160; DataServiceContext instance to
override the default type resolution behavior.

ex :
DataServiceContext dsc = new DataServiceContext(new Uri(&quot;URI_TO_DATASERVICE&quot;));
dsc.ResolveName = delegate(Type entityType) {
     return entityType.FullName.Replace(&quot;&lt;ClientNamespace&gt;&quot;, &quot;&lt;ServerNamespace&gt;&quot;);
};
dsc.ResolveType = delegate(string entitySetName) {
      return Type.GetType(entitySetName);
};
Employee newEmployee = new Employee() {Name = &quot;Peter Qian&quot;};
dsc.AddObject(&quot;People&quot;, newEmployee);
dsc.SaveChanges();
Since we provide the right Entity Type Name in the ResolveName property , the right Entity Type
is placed in the payload.
&lt;entry xmlns:d=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices&quot;
       xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata       xmlns=&quot;http://www.w3.org/2005/Atom&quot;&gt;
&lt;category scheme=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices/scheme&quot; term=&quot;ServerNamespace.Employee&quot; /&gt;
&lt;updated&gt;2008-12-23T21:52:44.8021175Z&lt;/updated&gt;
&lt;content type=&quot;application/xml&quot;&gt;
    &lt;m:properties&gt;
      &lt;d:EmployeeID m:type=&quot;Edm.Int32&quot;&gt;0&lt;/d:EmployeeID&gt;
      &lt;d:Name&gt;Peter Qian&lt;/d:Name&gt;
      &lt;d:PersonID m:type=&quot;Edm.Int32&quot;&gt;0&lt;/d:PersonID&gt;
    &lt;/m:properties&gt;
  &lt;/content&gt;
&lt;/entry&gt;
Hope this helps .
" />
    
    <meta name="author" content="Phani Raj" />

    
    <meta property="og:title" content="Working with Inheritance in Ado.net Data Services" />
    <meta property="twitter:title" content="Working with Inheritance in Ado.net Data Services" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Phani Raj - Technical Lead at HP Cloud" href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="https://raw.githubusercontent.com/barryclark/jekyll-now/master/images/jekyll-logo.png" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">Phani Raj</a></h1>
            <p class="site-description">Technical Lead at HP Cloud</p>
          </div>

          <nav>
            <a href="/">Blog</a>
            <a href="/about">About</a>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>Working with Inheritance in Ado.net Data Services</h1>

  <div class="entry">
    <p>I’ve seen this question quite often on the Astoria forums and wanted to write something down so that our users can gain from the discussions that go on in our forums.    <br />We will discuss how one deals with entities ( tables / records / resources ) that participate in an inheritance hierarchy.     <br />We shall take the following Data Model to discuss some key scenarios involving the Client Library. </p>
<pre class="darkcsharpcode"><span class="rem">//Base Class</span>
[DataServiceKey(<span class="str">&quot;PersonID&quot;</span>)]
<span class="kwrd">public</span> <span class="kwrd">class</span> Person {
        <span class="kwrd">public</span> <span class="kwrd">int</span> PersonID { get; set; }
        <span class="kwrd">public</span> <span class="kwrd">string</span> Name { get; set; }
    }

<span class="rem">//Derived Class</span>
<span class="kwrd">public</span> <span class="kwrd">class</span> Employee : Person {
        <span class="kwrd">public</span> <span class="kwrd">int</span> EmployeeID { get; set; }
}</pre>
<p>And you expose an IQueryable&lt;Person&gt; from your data source,</p>
<pre class="darkcsharpcode"><span class="kwrd">public</span> <span class="kwrd">class</span> InheritedProvider {
        <span class="kwrd">static</span> List&lt;Person&gt; _people;
        <span class="kwrd">private</span> <span class="kwrd">static</span> <span class="kwrd">void</span> Initialize()  {
            _people = <span class="kwrd">new</span> List&lt;Person&gt;(){
                <span class="kwrd">new</span> Person  {
                    PersonID =1,
                    Name=<span class="str">&quot;Phani&quot;</span>
                },
                <span class="kwrd">new</span> Employee {
                    PersonID =2,
                    EmployeeID =3,
                    Name =<span class="str">&quot;Raj&quot;</span>
                }
            };
        }
        <span class="kwrd">public</span> IQueryable&lt;Person&gt; People {
            get {
                <span class="kwrd">if</span> (_people == <span class="kwrd">null</span>)
                    Initialize();
                <span class="kwrd">return</span> _people.AsQueryable&lt;Person&gt;();
            }
        }
    }</pre>
<p>Browsing to the /People endpoint of the service gives you : </p>
<p>
  <br />&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;yes&quot; ?&gt;</p>
<p>&lt;feed …Namespace Declarations… &gt;</p>
<p>&#160; &lt;title type=&quot;text&quot;&gt;People&lt;/title&gt;</p>
<p>&#160; &lt;id&gt;<a href="http://localhost:13975/Inheritance.svc/People">http://localhost:13975/Inheritance.svc/People</a>&lt;/id&gt;</p>
<p>&#160; &lt;updated&gt;2008-12-23T20:56:47Z&lt;/updated&gt;</p>
<p>&#160; &lt;link rel=&quot;self&quot; title=&quot;People&quot; href=&quot;People&quot; /&gt;</p>
<p>&#160; &lt;entry&gt;</p>
<p>&#160; &lt;id&gt;<a href="http://localhost:13975/Inheritance.svc/People(1)">http://localhost:13975/Inheritance.svc/People(1)</a>&lt;/id&gt;</p>
<p>&#160; &lt;title type=&quot;text&quot; /&gt;</p>
<p>&#160; &lt;updated&gt;2008-12-23T20:56:47Z&lt;/updated&gt;</p>
<p>&#160; &lt;author&gt;</p>
<p>&#160; &lt;name /&gt;</p>
<p>&#160; &lt;/author&gt;</p>
<p>&#160; &lt;link rel=&quot;edit&quot; title=&quot;Person&quot; href=&quot;People(1)&quot; /&gt;&#160;&#160; </p>
<pre class="darkcsharpcode"><span class="kwrd">&lt;</span><span class="html">category</span> <span class="attr">term</span><span class="kwrd">=&quot;Repro.Person&quot;</span> <span class="attr">scheme</span><span class="kwrd">=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices/scheme&quot;</span> <span class="kwrd">/&gt;</span> </pre>
<p>&lt;content type=&quot;application/xml&quot;&gt;<br />
  <br />&#160; &lt;m:properties&gt;</p>
<p>&#160; &lt;d:PersonID m:type=&quot;Edm.Int32&quot;&gt;1&lt;/d:PersonID&gt;</p>
<p>&#160; &lt;d:Name&gt;Phani&lt;/d:Name&gt;</p>
<p>&#160; &lt;/m:properties&gt;</p>
<p>&#160; &lt;/content&gt;</p>
<p>&#160; &lt;/entry&gt;</p>
<p>&#160; &lt;entry&gt;</p>
<p>&#160; &lt;id&gt;<a href="http://localhost:13975/Inheritance.svc/People(2)">http://localhost:13975/Inheritance.svc/People(2)</a>&lt;/id&gt;</p>
<p>&#160; &lt;title type=&quot;text&quot; /&gt;</p>
<p>&#160; &lt;updated&gt;2008-12-23T20:56:47Z&lt;/updated&gt;</p>
<p>&#160; &lt;author&gt;</p>
<p>&#160; &lt;name /&gt;</p>
<p>&#160; &lt;/author&gt;</p>
<p>&#160; &lt;link rel=&quot;edit&quot; title=&quot;Person&quot; href=&quot;People(2)&quot; /&gt;&#160; </p>
<pre class="darkcsharpcode"><span class="kwrd">&lt;</span><span class="html">category</span> <span class="attr">term</span><span class="kwrd">=&quot;Repro.Employee&quot;</span> <span class="attr">scheme</span><span class="kwrd">=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices/scheme&quot;</span> <span class="kwrd">/&gt;</span></pre>
<p>&#160; &lt;content type=&quot;application/xml&quot;&gt;<br />
  <br />&#160; &lt;m:properties&gt;</p>
<p>&#160; &lt;d:PersonID m:type=&quot;Edm.Int32&quot;&gt;2&lt;/d:PersonID&gt;</p>
<p>&#160; &lt;d:Name&gt;Raj&lt;/d:Name&gt;</p>
<p>&#160; &lt;d:EmployeeID m:type=&quot;Edm.Int32&quot;&gt;3&lt;/d:EmployeeID&gt;</p>
<p>&#160; &lt;/m:properties&gt;</p>
<p>&#160; &lt;/content&gt;</p>
<p>&#160; &lt;/entry&gt;</p>
<p>&#160; &lt;/feed&gt; </p>
<p>As you can see , the &lt;Category&gt; element of an &lt;entry&gt; element represents the Entity Type that this &lt;entry&gt; represents.<br />
  </p>
<h5>How does this help one with working with against an Entity Set using Inheritance ?</h5>
<p>Consider the following snippet of Client Code :</p>
<pre class="darkcsharpcode">DataServiceContext dsc = <span class="kwrd">new</span> DataServiceContext(<span class="kwrd">new</span> Uri(<span class="str">&quot;URI_TO_DATASERVICE&quot;</span>));
Employee newEmployee = <span class="kwrd">new</span> Employee() {Name = <span class="str">&quot;Peter Qian&quot;</span>};
dsc.AddObject(<span class="str">&quot;People&quot;</span>, newEmployee);
dsc.SaveChanges();</pre>
<p>Can you guess what is wrong with this ?</p>
<p>Yep, since the client library sees that you are trying to insert a Person Entity , we put the Entity Type as “Person”</p>
<p>in the payload , i.e , the above operation results in the payload :</p>
<pre class="darkcsharpcode"><span class="kwrd">&lt;</span><span class="html">entry</span> <span class="attr">xmlns:d</span><span class="kwrd">=<a href="http://schemas.microsoft.com/ado/2007/08/dataservices">http://schemas.microsoft.com/ado/2007/08/dataservices</a></span> <br /><span class="attr">       xmlns:m</span><span class="kwrd">=<a href="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata">http://schemas.microsoft.com/ado/2007/08/dataservices/metadata</a></span> <br /><span class="attr">       xmlns</span><span class="kwrd">=&quot;http://www.w3.org/2005/Atom&quot;</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;</span><span class="html">updated</span><span class="kwrd">&gt;</span>2008-12-23T21:23:38.5935141Z<span class="kwrd">&lt;/</span><span class="html">updated</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;</span><span class="html">content</span> <span class="attr">type</span><span class="kwrd">=&quot;application/xml&quot;</span><span class="kwrd">&gt;</span>
   <span class="kwrd">&lt;</span><span class="html">m:properties</span><span class="kwrd">&gt;</span>
     <span class="kwrd">&lt;</span><span class="html">d:EmployeeID</span> <span class="attr">m:type</span><span class="kwrd">=&quot;Edm.Int32&quot;</span><span class="kwrd">&gt;</span>0<span class="kwrd">&lt;/</span><span class="html">d:EmployeeID</span><span class="kwrd">&gt;</span>
     <span class="kwrd">&lt;</span><span class="html">d:Name</span><span class="kwrd">&gt;</span>Peter Qian<span class="kwrd">&lt;/</span><span class="html">d:Name</span><span class="kwrd">&gt;</span>
     <span class="kwrd">&lt;</span><span class="html">d:PersonID</span> <span class="attr">m:type</span><span class="kwrd">=&quot;Edm.Int32&quot;</span><span class="kwrd">&gt;</span>0<span class="kwrd">&lt;/</span><span class="html">d:PersonID</span><span class="kwrd">&gt;</span>
   <span class="kwrd">&lt;/</span><span class="html">m:properties</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">content</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">entry</span><span class="kwrd">&gt;</span></pre>
<p></p>
<p>And this causes the Server to respond with :<br />
  </p>
<pre class="darkcsharpcode"><span class="kwrd">&lt;?</span><span class="html">xml</span> <span class="attr">version</span><span class="kwrd">=&quot;1.0&quot;</span> <span class="attr">encoding</span><span class="kwrd">=&quot;utf-8&quot;</span> <span class="attr">standalone</span><span class="kwrd">=&quot;yes&quot;</span>?<span class="kwrd">&gt;</span>
<span class="kwrd">&lt;</span><span class="html">error</span> <span class="attr">xmlns</span><span class="kwrd">=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices/metadata&quot;</span><span class="kwrd">&gt;</span>
  <span class="kwrd">&lt;</span><span class="html">code</span><span class="kwrd">&gt;&lt;/</span><span class="html">code</span><span class="kwrd">&gt;</span>
  <span class="kwrd">&lt;</span><span class="html">message</span> <span class="attr">xml:lang</span><span class="kwrd">=&quot;en-US&quot;</span><span class="kwrd">&gt;</span>Error processing request stream.
    Type information must be specified for types that take part in inheritance.<span class="kwrd">&lt;/</span><span class="html">message</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">error</span><span class="kwrd">&gt;</span></pre>
<p>This error is because , as you can see in the request payload , the &lt;category&gt; element which specifies the Entity Type is missing form the Request Payload.<br />
  <br />Since the Client library doesn’t resolve the Names/Types of the Entities for you , it provides you hooks to customize the name/type resolution</p>
<p>so that the right entity type is specified in the payloads.</p>
<h5>Why can’t the Client library do this automatically ?</h5>
<p>Main reason , Since we allow POCO , the type hierarchy of entities on the client can be different compared to the server.<br />
  </p>
<p>In your client code , set the <a href="http://msdn.microsoft.com/en-us/library/system.data.services.client.dataservicecontext.resolvename(VS.95).aspx" target="_blank">ResolveName</a> and <a href="http://msdn.microsoft.com/en-us/library/system.data.services.client.dataservicecontext.resolvetype.aspx" target="_blank">ResolveType</a> Properties on the&#160; DataServiceContext instance to</p>
<p>override the default type resolution behavior.</p>
<p></p>
<p>ex :</p></p>
<pre class="darkcsharpcode">DataServiceContext dsc = <span class="kwrd">new</span> DataServiceContext(<span class="kwrd">new</span> Uri(<span class="str">&quot;URI_TO_DATASERVICE&quot;</span>));
dsc.ResolveName = <span class="kwrd">delegate</span>(Type entityType) {
     <span class="kwrd">return</span> entityType.FullName.Replace(<span class="str">&quot;&lt;ClientNamespace&gt;&quot;</span>, <span class="str">&quot;&lt;ServerNamespace&gt;&quot;</span>);
};
dsc.ResolveType = <span class="kwrd">delegate</span>(<span class="kwrd">string</span> entitySetName) {
      <span class="kwrd">return</span> Type.GetType(entitySetName);
};
Employee newEmployee = <span class="kwrd">new</span> Employee() {Name = <span class="str">&quot;Peter Qian&quot;</span>};
dsc.AddObject(<span class="str">&quot;People&quot;</span>, newEmployee);
dsc.SaveChanges();</pre>
<p>Since we provide the right Entity Type Name in the ResolveName property , the right Entity Type</p>
<p>is placed in the payload.</p>
<pre class="darkcsharpcode"><span class="kwrd">&lt;</span><span class="html">entry</span> <span class="attr">xmlns:d</span><span class="kwrd">=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices&quot;</span>
<span class="attr">       xmlns:m</span><span class="kwrd">=<a href="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata">http://schemas.microsoft.com/ado/2007/08/dataservices/metadata</a><br /></span><span class="attr">       xmlns</span><span class="kwrd">=&quot;http://www.w3.org/2005/Atom&quot;</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;</span><span class="html">category</span> <span class="attr">scheme</span><span class="kwrd">=&quot;http://schemas.microsoft.com/ado/2007/08/dataservices/scheme&quot;</span> <span class="attr">term</span><span class="kwrd">=&quot;ServerNamespace.Employee&quot;</span> <span class="kwrd">/&gt;</span>
<span class="kwrd">&lt;</span><span class="html">updated</span><span class="kwrd">&gt;</span>2008-12-23T21:52:44.8021175Z<span class="kwrd">&lt;/</span><span class="html">updated</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;</span><span class="html">content</span> <span class="attr">type</span><span class="kwrd">=&quot;application/xml&quot;</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">m:properties</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">d:EmployeeID</span> <span class="attr">m:type</span><span class="kwrd">=&quot;Edm.Int32&quot;</span><span class="kwrd">&gt;</span>0<span class="kwrd">&lt;/</span><span class="html">d:EmployeeID</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">d:Name</span><span class="kwrd">&gt;</span>Peter Qian<span class="kwrd">&lt;/</span><span class="html">d:Name</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">d:PersonID</span> <span class="attr">m:type</span><span class="kwrd">=&quot;Edm.Int32&quot;</span><span class="kwrd">&gt;</span>0<span class="kwrd">&lt;/</span><span class="html">d:PersonID</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">m:properties</span><span class="kwrd">&gt;</span>
  <span class="kwrd">&lt;/</span><span class="html">content</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">entry</span><span class="kwrd">&gt;</span></pre>
<p>Hope this helps .</p>

  </div>

  <div class="date">
    Written on December 23, 2008
  </div>

  
</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          



<a href="https://github.com/barryclark/jekyll-now"><i class="svg-icon github"></i></a>




<a href="https://www.twitter.com/jekyllrb"><i class="svg-icon twitter"></i></a>



        </footer>
      </div>
    </div>

    

  </body>
</html>
