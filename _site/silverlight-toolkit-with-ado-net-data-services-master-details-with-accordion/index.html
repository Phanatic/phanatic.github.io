<!DOCTYPE html>
<html>
  <head>
    <title>Silverlight toolkit with ADO.NET Data services , Master-Details with Accordion – Phani Raj – Technical Lead at HP Cloud</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="Download the sample Silverlight project here : 
 
About the Silverlight toolkit&#160; , 
From their Codeplex page : http://silverlight.codeplex.com/
“The Silverlight Toolkit is a collection of Silverlight controls, components and utilities made available outside the normal Silverlight release cycle”
In the first of a series I am planning , we will talk about how to achieve a Master-Child display using the Accordion control&#160; from the Silverlight Toolkit control.
The data model we will be binding looks like this :
 
Type Employee has a property called Department of type Department.    Type Department has a collection of type Employee called Employees.
Employee and Department are related 1..1    Department and Employee are related 1..M
We want to bind the Department names to the header of the Accordion and    the employees as a list inside the content of the accordion.     When we are done , the final output should look like this :

Configuring the header to show the DepartmentName
The Header template of the Accordion has a textblock which binds to the DepartMentName property of the    Department entity.     
 &lt;layoutToolkit:Accordion.HeaderTemplate &gt;
       &lt;DataTemplate&gt;
            &lt;TextBlock Text=&quot;{Binding Path=DepartMentName}&quot;&gt;&lt;/TextBlock&gt;
       &lt;/DataTemplate&gt;
 &lt;/layoutToolkit:Accordion.HeaderTemplate&gt;
Configuring the content to show the names of the employees working in the department.
The content of the Accordion pane would be a list box which is bound to the Employees collection of the Department
  entity type and shows the EmployeeName as the DisplayMember.

&lt;layoutToolkit:Accordion.ContentTemplate&gt;
      &lt;DataTemplate&gt;
          &lt;ListBox ItemsSource=&quot;{Binding Employees}&quot; DisplayMemberPath=&quot;EmployeeName&quot;&gt;
          &lt;/ListBox&gt;
      &lt;/DataTemplate&gt;
&lt;/layoutToolkit:Accordion.ContentTemplate&gt;

To write the Silverlight client code for this project ,we will need to generate the Client classes with Databinding enabled.
  As shown in this article on our team blog .
Once this is done , we have two ways of binding the accordion ,
  Eager Loading : Download the employees for a department when you download the departments
Lazy Load : Download the employees for a department when the header of an accordion pane , i.e Department is clicked.
Eager Loading :
DataServiceQuery&lt;Department&gt; deptQueryWithEmployees = context.Departments.Expand(&quot;Employees&quot;) as DataServiceQuery&lt;Department&gt;;deptQueryWithEmployees.QueryAndBind(acDepartments);

Since the query part itself isnt interesting in the context of this blog post , I’ve abstracted away the querying into an extension method ( QueryAndBind ) and will be available as part of the download.
  
Here , as you can see , we are eager loading the Employees for the departments .
  I feel that this is wasteful if you have a large number of departments as this not only increases the amount of data on the wire , but it also means that all the data that comes down the wire will be useful .
For example, if you have about 15 departments and a user may click on 5 or less departments , then downloading employees for all the 15 departments seems inefficient.
  
Xaml for Eager Loading
&lt;layoutToolkit:Accordion x:Name=&quot;acDepartments&quot; Width=&quot;400&quot;&gt;
    &lt;layoutToolkit:Accordion.HeaderTemplate &gt;
        &lt;DataTemplate&gt;
            &lt;TextBlock Text=&quot;{Binding Path=DepartMentName}&quot;&gt;&lt;/TextBlock&gt;
        &lt;/DataTemplate&gt;
    &lt;/layoutToolkit:Accordion.HeaderTemplate&gt;
    &lt;layoutToolkit:Accordion.ContentTemplate&gt;
        &lt;DataTemplate&gt;
            &lt;ListBox ItemsSource=&quot;{Binding Employees}&quot; DisplayMemberPath=&quot;EmployeeName&quot;&gt;
            &lt;/ListBox&gt;
        &lt;/DataTemplate&gt;
    &lt;/layoutToolkit:Accordion.ContentTemplate&gt;
&lt;/layoutToolkit:Accordion&gt;

Lazy Loading :
    In this case , we will only bind the Headers and&#160; will bind the Employees only if the header is clicked for that department. In the Silverlight Accordion control , the event SelectionChanged is fired when the header of an Accordion Pane is clicked.
By listening to this event , we can find out which department was clicked and load the Employees for that department using BeginLoadProperty .

public DelayLoad() {
           InitializeComponent();
           context = new TreeViewDataProvider(new Uri(&quot;TreeViewDataService.svc&quot;, UriKind.RelativeOrAbsolute));
           LoadDepartments();
}
private void LoadDepartments(){
    ((DataServiceQuery&lt;Department&gt;)context.Departments).QueryAndBind(acDepartments);
}
We will subscribe to the SelectionChanged event of the Accordion and add “LoadEmployeesForDepartment” as the event handler.
private void LoadEmployeesForDepartment(object sender, SelectionChangedEventArgs e)
        {
            //The sender is the control that raised the event
            Accordion acControl = sender as Accordion;
            //Get the Selected Department
            Department selectedDepartment = acControl.SelectedItem as Department;
            if (
                //If the Selected object is department
                selectedDepartment != null
                &amp;&amp; (
                // If the Employees collection is null or empty
                selectedDepartment.Employees == null || selectedDepartment.Employees.Count == 0)
                )
            {
                //Call load property , which updates the Employees collection of this instance
                //and the UI automatically updates itself, since Department type implements INotifyPropertyChanged
                context.LoadPropertyAndCall&lt;Employee&gt;(selectedDepartment, &quot;Employees&quot;,
                    null);
            }

        }

XAML for Delay Load :
&lt;layoutToolkit:Accordion x:Name=&quot;acDepartments&quot; SelectionChanged=&quot;LoadEmployeesForDepartment&quot;&gt;
    &lt;layoutToolkit:Accordion.HeaderTemplate &gt;
        &lt;DataTemplate&gt;
            &lt;TextBlock Text=&quot;{Binding Path=DepartMentName}&quot;&gt;&lt;/TextBlock&gt;
        &lt;/DataTemplate&gt;
    &lt;/layoutToolkit:Accordion.HeaderTemplate&gt;
    &lt;layoutToolkit:Accordion.ContentTemplate&gt;
        &lt;DataTemplate&gt;
            &lt;ListBox ItemsSource=&quot;{Binding Employees}&quot; DisplayMemberPath=&quot;EmployeeName&quot;&gt;
            &lt;/ListBox&gt;
        &lt;/DataTemplate&gt;
    &lt;/layoutToolkit:Accordion.ContentTemplate&gt;
&lt;/layoutToolkit:Accordion&gt;

Download the sample Silverlight project here : 

Running the sample app 

Set SLToolkitWithAstoriaWeb as the Start-up project. 
Set SLToolkitWithAstoriaTestPage.html as the start-up page. 
To run the EagerLoading sample , just hit F5 
To run the DelayLoad sample , follow a-c and add the Query string ?delayLoad to the address bar in the browser that comes up. 

" />
    <meta property="og:description" content="Download the sample Silverlight project here : 
 
About the Silverlight toolkit&#160; , 
From their Codeplex page : http://silverlight.codeplex.com/
“The Silverlight Toolkit is a collection of Silverlight controls, components and utilities made available outside the normal Silverlight release cycle”
In the first of a series I am planning , we will talk about how to achieve a Master-Child display using the Accordion control&#160; from the Silverlight Toolkit control.
The data model we will be binding looks like this :
 
Type Employee has a property called Department of type Department.    Type Department has a collection of type Employee called Employees.
Employee and Department are related 1..1    Department and Employee are related 1..M
We want to bind the Department names to the header of the Accordion and    the employees as a list inside the content of the accordion.     When we are done , the final output should look like this :

Configuring the header to show the DepartmentName
The Header template of the Accordion has a textblock which binds to the DepartMentName property of the    Department entity.     
 &lt;layoutToolkit:Accordion.HeaderTemplate &gt;
       &lt;DataTemplate&gt;
            &lt;TextBlock Text=&quot;{Binding Path=DepartMentName}&quot;&gt;&lt;/TextBlock&gt;
       &lt;/DataTemplate&gt;
 &lt;/layoutToolkit:Accordion.HeaderTemplate&gt;
Configuring the content to show the names of the employees working in the department.
The content of the Accordion pane would be a list box which is bound to the Employees collection of the Department
  entity type and shows the EmployeeName as the DisplayMember.

&lt;layoutToolkit:Accordion.ContentTemplate&gt;
      &lt;DataTemplate&gt;
          &lt;ListBox ItemsSource=&quot;{Binding Employees}&quot; DisplayMemberPath=&quot;EmployeeName&quot;&gt;
          &lt;/ListBox&gt;
      &lt;/DataTemplate&gt;
&lt;/layoutToolkit:Accordion.ContentTemplate&gt;

To write the Silverlight client code for this project ,we will need to generate the Client classes with Databinding enabled.
  As shown in this article on our team blog .
Once this is done , we have two ways of binding the accordion ,
  Eager Loading : Download the employees for a department when you download the departments
Lazy Load : Download the employees for a department when the header of an accordion pane , i.e Department is clicked.
Eager Loading :
DataServiceQuery&lt;Department&gt; deptQueryWithEmployees = context.Departments.Expand(&quot;Employees&quot;) as DataServiceQuery&lt;Department&gt;;deptQueryWithEmployees.QueryAndBind(acDepartments);

Since the query part itself isnt interesting in the context of this blog post , I’ve abstracted away the querying into an extension method ( QueryAndBind ) and will be available as part of the download.
  
Here , as you can see , we are eager loading the Employees for the departments .
  I feel that this is wasteful if you have a large number of departments as this not only increases the amount of data on the wire , but it also means that all the data that comes down the wire will be useful .
For example, if you have about 15 departments and a user may click on 5 or less departments , then downloading employees for all the 15 departments seems inefficient.
  
Xaml for Eager Loading
&lt;layoutToolkit:Accordion x:Name=&quot;acDepartments&quot; Width=&quot;400&quot;&gt;
    &lt;layoutToolkit:Accordion.HeaderTemplate &gt;
        &lt;DataTemplate&gt;
            &lt;TextBlock Text=&quot;{Binding Path=DepartMentName}&quot;&gt;&lt;/TextBlock&gt;
        &lt;/DataTemplate&gt;
    &lt;/layoutToolkit:Accordion.HeaderTemplate&gt;
    &lt;layoutToolkit:Accordion.ContentTemplate&gt;
        &lt;DataTemplate&gt;
            &lt;ListBox ItemsSource=&quot;{Binding Employees}&quot; DisplayMemberPath=&quot;EmployeeName&quot;&gt;
            &lt;/ListBox&gt;
        &lt;/DataTemplate&gt;
    &lt;/layoutToolkit:Accordion.ContentTemplate&gt;
&lt;/layoutToolkit:Accordion&gt;

Lazy Loading :
    In this case , we will only bind the Headers and&#160; will bind the Employees only if the header is clicked for that department. In the Silverlight Accordion control , the event SelectionChanged is fired when the header of an Accordion Pane is clicked.
By listening to this event , we can find out which department was clicked and load the Employees for that department using BeginLoadProperty .

public DelayLoad() {
           InitializeComponent();
           context = new TreeViewDataProvider(new Uri(&quot;TreeViewDataService.svc&quot;, UriKind.RelativeOrAbsolute));
           LoadDepartments();
}
private void LoadDepartments(){
    ((DataServiceQuery&lt;Department&gt;)context.Departments).QueryAndBind(acDepartments);
}
We will subscribe to the SelectionChanged event of the Accordion and add “LoadEmployeesForDepartment” as the event handler.
private void LoadEmployeesForDepartment(object sender, SelectionChangedEventArgs e)
        {
            //The sender is the control that raised the event
            Accordion acControl = sender as Accordion;
            //Get the Selected Department
            Department selectedDepartment = acControl.SelectedItem as Department;
            if (
                //If the Selected object is department
                selectedDepartment != null
                &amp;&amp; (
                // If the Employees collection is null or empty
                selectedDepartment.Employees == null || selectedDepartment.Employees.Count == 0)
                )
            {
                //Call load property , which updates the Employees collection of this instance
                //and the UI automatically updates itself, since Department type implements INotifyPropertyChanged
                context.LoadPropertyAndCall&lt;Employee&gt;(selectedDepartment, &quot;Employees&quot;,
                    null);
            }

        }

XAML for Delay Load :
&lt;layoutToolkit:Accordion x:Name=&quot;acDepartments&quot; SelectionChanged=&quot;LoadEmployeesForDepartment&quot;&gt;
    &lt;layoutToolkit:Accordion.HeaderTemplate &gt;
        &lt;DataTemplate&gt;
            &lt;TextBlock Text=&quot;{Binding Path=DepartMentName}&quot;&gt;&lt;/TextBlock&gt;
        &lt;/DataTemplate&gt;
    &lt;/layoutToolkit:Accordion.HeaderTemplate&gt;
    &lt;layoutToolkit:Accordion.ContentTemplate&gt;
        &lt;DataTemplate&gt;
            &lt;ListBox ItemsSource=&quot;{Binding Employees}&quot; DisplayMemberPath=&quot;EmployeeName&quot;&gt;
            &lt;/ListBox&gt;
        &lt;/DataTemplate&gt;
    &lt;/layoutToolkit:Accordion.ContentTemplate&gt;
&lt;/layoutToolkit:Accordion&gt;

Download the sample Silverlight project here : 

Running the sample app 

Set SLToolkitWithAstoriaWeb as the Start-up project. 
Set SLToolkitWithAstoriaTestPage.html as the start-up page. 
To run the EagerLoading sample , just hit F5 
To run the DelayLoad sample , follow a-c and add the Query string ?delayLoad to the address bar in the browser that comes up. 

" />
    
    <meta name="author" content="Phani Raj" />

    
    <meta property="og:title" content="Silverlight toolkit with ADO.NET Data services , Master-Details with Accordion" />
    <meta property="twitter:title" content="Silverlight toolkit with ADO.NET Data services , Master-Details with Accordion" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Phani Raj - Technical Lead at HP Cloud" href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="https://raw.githubusercontent.com/barryclark/jekyll-now/master/images/jekyll-logo.png" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">Phani Raj</a></h1>
            <p class="site-description">Technical Lead at HP Cloud</p>
          </div>

          <nav>
            <a href="/">Blog</a>
            <a href="/about">About</a>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>Silverlight toolkit with ADO.NET Data services , Master-Details with Accordion</h1>

  <div class="entry">
    <p>Download the sample Silverlight project here : </p>
<p> <iframe style="border-bottom: #dde5e9 1px solid; border-left: #dde5e9 1px solid; padding-bottom: 0px; background-color: #ffffff; margin: 3px; padding-left: 0px; width: 240px; padding-right: 0px; height: 26px; border-top: #dde5e9 1px solid; border-right: #dde5e9 1px solid; padding-top: 0px" marginheight="0" src="http://cid-925c2d2bb2d03c6b.skydrive.live.com/embedrow.aspx/SLToolkitAstoria/SLToolkitWithAstoria.zip" frameborder="0" marginwidth="0" scrolling="no"></iframe>
<p>About the Silverlight toolkit&#160; , </p>
<p>From their Codeplex page : <a title="http://silverlight.codeplex.com/" href="http://silverlight.codeplex.com/">http://silverlight.codeplex.com/</a></p>
<p><em>“The Silverlight Toolkit is a collection of Silverlight controls, components and utilities made available outside the normal Silverlight release cycle”</em></p>
<p>In the first of a series I am planning , we will talk about how to achieve a Master-Child display using the Accordion control&#160; <br />from the Silverlight Toolkit control.</p>
<p>The data model we will be binding looks like this :</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/BlogFileStorage/blogs_msdn/phaniraj/WindowsLiveWriter/Silverlighttoolk.NETDataservicesTreeView_10E57/SLToolkitAccordion_DataModel.png" original-url="http://blogs.msdn.com/blogfiles/phaniraj/WindowsLiveWriter/Silverlighttoolk.NETDataservicesTreeView_10E57/SLToolkitAccordion_DataModel.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="SLToolkitAccordion_DataModel" border="0" alt="SLToolkitAccordion_DataModel" src="/assets/SLToolkitAccordion_DataModel_thumb.png" original-url="http://blogs.msdn.com/blogfiles/phaniraj/WindowsLiveWriter/Silverlighttoolk.NETDataservicesTreeView_10E57/SLToolkitAccordion_DataModel_thumb.png" width="547" height="191" /></a> </p>
<p>Type Employee has a property called Department of type Department.    <br />Type Department has a collection of type Employee called Employees.</p>
<p>Employee and Department are related 1..1    <br />Department and Employee are related 1..M</p>
<p>We want to bind the Department names to the header of the Accordion and    <br />the employees as a list inside the content of the accordion.     <br />When we are done , the final output should look like this :</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/BlogFileStorage/blogs_msdn/phaniraj/WindowsLiveWriter/Silverlighttoolk.NETDataservicesTreeView_10E57/SLTOolkit_Accordionoutput.png" original-url="http://blogs.msdn.com/blogfiles/phaniraj/WindowsLiveWriter/Silverlighttoolk.NETDataservicesTreeView_10E57/SLTOolkit_Accordionoutput.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="SLTOolkit_Accordionoutput" border="0" alt="SLTOolkit_Accordionoutput" src="/assets/SLTOolkit_Accordionoutput_thumb.png" original-url="http://blogs.msdn.com/blogfiles/phaniraj/WindowsLiveWriter/Silverlighttoolk.NETDataservicesTreeView_10E57/SLTOolkit_Accordionoutput_thumb.png" width="464" height="115" /></a></p>
<p><strong>Configuring the header to show the DepartmentName</strong></p>
<p>The Header template of the Accordion has a textblock which binds to the DepartMentName property of the    <br />Department entity.     </p>
<pre class="code"><span style="color: blue"> &lt;</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion.HeaderTemplate </span><span style="color: blue">&gt;
       &lt;</span><span style="color: #a31515">DataTemplate</span><span style="color: blue">&gt;
            &lt;</span><span style="color: #a31515">TextBlock </span><span style="color: red">Text</span><span style="color: blue">=&quot;{</span><span style="color: #a31515">Binding </span><span style="color: red">Path</span><span style="color: blue">=DepartMentName}&quot;&gt;&lt;/</span><span style="color: #a31515">TextBlock</span><span style="color: blue">&gt;
       &lt;/</span><span style="color: #a31515">DataTemplate</span><span style="color: blue">&gt;
 &lt;/</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion.HeaderTemplate</span><span style="color: blue">&gt;</span></pre>
<p><strong>Configuring the content to show the names of the employees working in the department.</strong></p>
<p>The content of the Accordion pane would be a list box which is bound to the Employees collection of the Department<br />
  <br />entity type and shows the EmployeeName as the DisplayMember.</p>
<p></p>
<pre class="code"><span style="color: blue">&lt;</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion.ContentTemplate</span><span style="color: blue">&gt;
      &lt;</span><span style="color: #a31515">DataTemplate</span><span style="color: blue">&gt;
          &lt;</span><span style="color: #a31515">ListBox </span><span style="color: red">ItemsSource</span><span style="color: blue">=&quot;{</span><span style="color: #a31515">Binding </span><span style="color: red">Employees</span><span style="color: blue">}&quot; </span><span style="color: red">DisplayMemberPath</span><span style="color: blue">=&quot;EmployeeName&quot;&gt;
          &lt;/</span><span style="color: #a31515">ListBox</span><span style="color: blue">&gt;
      &lt;/</span><span style="color: #a31515">DataTemplate</span><span style="color: blue">&gt;
&lt;/</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion.ContentTemplate</span><span style="color: blue">&gt;</span></pre>
<p><a href="http://11011.net/software/vspaste"></a></p>
<p>To write the Silverlight client code for this project ,we will need to generate the Client classes with Databinding enabled.<br />
  <br />As shown in <a href="http://blogs.msdn.com/astoriateam/archive/2009/03/21/ado-net-data-services-v1-5-ctp1-data-binding-overview.aspx">this article</a> on our team blog .</p>
<p>Once this is done , we have two ways of binding the accordion ,<br />
  <br />Eager Loading : Download the employees for a department when you download the departments</p>
<p>Lazy Load : Download the employees for a department when the header of an accordion pane , i.e Department is clicked.</p>
<p><strong>Eager Loading :</strong></p>
<pre class="code"><span style="color: #2b91af">DataServiceQuery</span>&lt;<span style="color: #2b91af">Department</span>&gt; deptQueryWithEmployees = context.Departments.Expand(<span style="color: #a31515">&quot;Employees&quot;</span>) <span style="color: blue">as </span><span style="color: #2b91af">DataServiceQuery</span>&lt;<span style="color: #2b91af">Department</span>&gt;;<br />deptQueryWithEmployees.QueryAndBind(acDepartments);</pre>
<p><a href="http://11011.net/software/vspaste"></a><a href="http://11011.net/software/vspaste"></a></p>
<p>Since the query part itself isnt interesting in the context of this blog post , I’ve abstracted away the querying into an extension method ( QueryAndBind ) and will be available as part of the download.<br />
  </p>
<p>Here , as you can see , we are eager loading the Employees for the departments .<br />
  <br />I feel that this is wasteful if you have a large number of departments as this not only increases the amount of data on the wire , but it also means that all the data that comes down the wire will be useful .</p>
<p>For example, if you have about 15 departments and a user may click on 5 or less departments , then downloading employees for all the 15 departments seems inefficient.<br />
  </p>
<p><strong>Xaml for Eager Loading</strong></p>
<pre class="code"><span style="color: blue">&lt;</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion </span><span style="color: red">x</span><span style="color: blue">:</span><span style="color: red">Name</span><span style="color: blue">=&quot;acDepartments&quot; </span><span style="color: red">Width</span><span style="color: blue">=&quot;400&quot;&gt;
    &lt;</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion.HeaderTemplate </span><span style="color: blue">&gt;
        &lt;</span><span style="color: #a31515">DataTemplate</span><span style="color: blue">&gt;
            &lt;</span><span style="color: #a31515">TextBlock </span><span style="color: red">Text</span><span style="color: blue">=&quot;{</span><span style="color: #a31515">Binding </span><span style="color: red">Path</span><span style="color: blue">=DepartMentName}&quot;&gt;&lt;/</span><span style="color: #a31515">TextBlock</span><span style="color: blue">&gt;
        &lt;/</span><span style="color: #a31515">DataTemplate</span><span style="color: blue">&gt;
    &lt;/</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion.HeaderTemplate</span><span style="color: blue">&gt;
    &lt;</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion.ContentTemplate</span><span style="color: blue">&gt;
        &lt;</span><span style="color: #a31515">DataTemplate</span><span style="color: blue">&gt;
            &lt;</span><span style="color: #a31515">ListBox </span><span style="color: red">ItemsSource</span><span style="color: blue">=&quot;{</span><span style="color: #a31515">Binding </span><span style="color: red">Employees</span><span style="color: blue">}&quot; </span><span style="color: red">DisplayMemberPath</span><span style="color: blue">=&quot;EmployeeName&quot;&gt;
            &lt;/</span><span style="color: #a31515">ListBox</span><span style="color: blue">&gt;
        &lt;/</span><span style="color: #a31515">DataTemplate</span><span style="color: blue">&gt;
    &lt;/</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion.ContentTemplate</span><span style="color: blue">&gt;
&lt;/</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion</span><span style="color: blue">&gt;</span></pre>
<p><a href="http://11011.net/software/vspaste"></a></p>
<p><strong>Lazy Loading :<br />
    <br /></strong>In this case , we will only bind the Headers and&#160; will bind the Employees only if the header is clicked for that department. In the Silverlight Accordion control , the event SelectionChanged is fired when the header of an Accordion Pane is clicked.</p>
<p>By listening to this event , we can find out which department was clicked and load the Employees for that department using BeginLoadProperty .</p>
<p></p>
<pre class="code"><span style="color: blue">public </span>DelayLoad() {
           InitializeComponent();
           context = <span style="color: blue">new </span><span style="color: #2b91af">TreeViewDataProvider</span>(<span style="color: blue">new </span><span style="color: #2b91af">Uri</span>(<span style="color: #a31515">&quot;TreeViewDataService.svc&quot;</span>, <span style="color: #2b91af">UriKind</span>.RelativeOrAbsolute));
           LoadDepartments();
}
<span style="color: blue">private void </span>LoadDepartments(){
    ((<span style="color: #2b91af">DataServiceQuery</span>&lt;<span style="color: #2b91af">Department</span>&gt;)context.Departments).QueryAndBind(acDepartments);
}</pre>
<p>We will subscribe to the SelectionChanged event of the Accordion and add “LoadEmployeesForDepartment” as the event handler.</p>
<pre class="code"><span style="color: blue">private void </span>LoadEmployeesForDepartment(<span style="color: blue">object </span>sender, <span style="color: #2b91af">SelectionChangedEventArgs </span>e)
        {
            <span style="color: green">//The sender is the control that raised the event
            </span><span style="color: #2b91af">Accordion </span>acControl = sender <span style="color: blue">as </span><span style="color: #2b91af">Accordion</span>;
            <span style="color: green">//Get the Selected Department
            </span><span style="color: #2b91af">Department </span>selectedDepartment = acControl.SelectedItem <span style="color: blue">as </span><span style="color: #2b91af">Department</span>;
            <span style="color: blue">if </span>(
                <span style="color: green">//If the Selected object is department
                </span>selectedDepartment != <span style="color: blue">null
                </span>&amp;&amp; (
                <span style="color: green">// If the Employees collection is null or empty
                </span>selectedDepartment.Employees == <span style="color: blue">null </span>|| selectedDepartment.Employees.Count == 0)
                )
            {
                <span style="color: green">//Call load property , which updates the Employees collection of this instance
                //and the UI automatically updates itself, since Department type implements INotifyPropertyChanged
                </span>context.LoadPropertyAndCall&lt;<span style="color: #2b91af">Employee</span>&gt;(selectedDepartment, <span style="color: #a31515">&quot;Employees&quot;</span>,
                    <span style="color: blue">null</span>);
            }

        }</pre>
<p><a href="http://11011.net/software/vspaste"></a></p>
<p><strong>XAML for Delay Load :</strong></p>
<pre class="code"><span style="color: blue">&lt;</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion </span><span style="color: red">x</span><span style="color: blue">:</span><span style="color: red">Name</span><span style="color: blue">=&quot;acDepartments&quot; </span><span style="color: red">SelectionChanged</span><span style="color: blue">=&quot;LoadEmployeesForDepartment&quot;&gt;
    &lt;</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion.HeaderTemplate </span><span style="color: blue">&gt;
        &lt;</span><span style="color: #a31515">DataTemplate</span><span style="color: blue">&gt;
            &lt;</span><span style="color: #a31515">TextBlock </span><span style="color: red">Text</span><span style="color: blue">=&quot;{</span><span style="color: #a31515">Binding </span><span style="color: red">Path</span><span style="color: blue">=DepartMentName}&quot;&gt;&lt;/</span><span style="color: #a31515">TextBlock</span><span style="color: blue">&gt;
        &lt;/</span><span style="color: #a31515">DataTemplate</span><span style="color: blue">&gt;
    &lt;/</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion.HeaderTemplate</span><span style="color: blue">&gt;
    &lt;</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion.ContentTemplate</span><span style="color: blue">&gt;
        &lt;</span><span style="color: #a31515">DataTemplate</span><span style="color: blue">&gt;
            &lt;</span><span style="color: #a31515">ListBox </span><span style="color: red">ItemsSource</span><span style="color: blue">=&quot;{</span><span style="color: #a31515">Binding </span><span style="color: red">Employees</span><span style="color: blue">}&quot; </span><span style="color: red">DisplayMemberPath</span><span style="color: blue">=&quot;EmployeeName&quot;&gt;
            &lt;/</span><span style="color: #a31515">ListBox</span><span style="color: blue">&gt;
        &lt;/</span><span style="color: #a31515">DataTemplate</span><span style="color: blue">&gt;
    &lt;/</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion.ContentTemplate</span><span style="color: blue">&gt;
&lt;/</span><span style="color: #a31515">layoutToolkit</span><span style="color: blue">:</span><span style="color: #a31515">Accordion</span><span style="color: blue">&gt;</span></pre>
<p><a href="http://11011.net/software/vspaste"></a></p>
<p>Download the sample Silverlight project here : </p>
<p><iframe style="border-bottom: #dde5e9 1px solid; border-left: #dde5e9 1px solid; padding-bottom: 0px; background-color: #ffffff; margin: 3px; padding-left: 0px; width: 240px; padding-right: 0px; height: 26px; border-top: #dde5e9 1px solid; border-right: #dde5e9 1px solid; padding-top: 0px" marginheight="0" src="http://cid-925c2d2bb2d03c6b.skydrive.live.com/embedrow.aspx/SLToolkitAstoria/SLToolkitWithAstoria.zip" frameborder="0" marginwidth="0" scrolling="no"></iframe></p>
<p><strong>Running the sample app </strong></p>
<ol>
<li>Set SLToolkitWithAstoriaWeb as the Start-up project. </li>
<li>Set SLToolkitWithAstoriaTestPage.html as the start-up page. </li>
<li>To run the EagerLoading sample , just hit F5 </li>
<li>To run the DelayLoad sample , follow a-c and add the Query string ?delayLoad to the address bar in the browser that comes up. </li>
</ol>

  </div>

  <div class="date">
    Written on June 10, 2009
  </div>

  
</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          



<a href="https://github.com/barryclark/jekyll-now"><i class="svg-icon github"></i></a>




<a href="https://www.twitter.com/jekyllrb"><i class="svg-icon twitter"></i></a>



        </footer>
      </div>
    </div>

    

  </body>
</html>
