---
layout: post
title: Sys.Preview.Timer Control - A Client Side Timer
date: 2007-03-15 03:17:00.000000000 -04:00
type: post
published: true
status: publish
categories: []
tags:
- Components
- JavaScript
- Sys.Preview
- Timer
meta:
  _encloseme: '1'
  orig_url: http://blogs.msdn.microsoft.com/b/phaniraj/archive/2007/03/15/sys-preview-timer-control-a-client-side-timer.aspx
  orig_site_id: '7524'
  orig_post_id: '1885299'
  orig_parent_id: '1885299'
  orig_thread_id: '501400'
  _wds_ratings_users: '0'
  orig_application_key: phaniraj
  orig_post_author_id: '56365'
  orig_post_author_username: PhaniRajuYN
  orig_post_author_created: Nov 10 2006 05:47:39:000PM
  orig_is_approved: '1'
  orig_attachment_count: '1'
  orig_url_title: http://blogs.msdn.com/b/phaniraj/archive/2007/03/15/sys-preview-timer-control-a-client-side-timer.aspx
  opengraph_tags: |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Sys.Preview.Timer Control &#8211; A Client Side Timer" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/phaniraj/2007/03/15/sys-preview-timer-control-a-client-side-timer/" />
    <meta property="og:site_name" content="With Great Power comes Great Response.write(&#039;Ability&#039;)" />
    <meta property="og:description" content="We have quite often come across&nbsp; scenarios where-in we need to execute certain client-Side code at certain intervals . What we often ended up doing is to use the&nbsp;window.setTimeOut() and the&nbsp;window.setInterval functions of IE to execute an expression at certain intervals of time . &nbsp; The Sys.Preview.Timer Provides an abstraction over these functions and makes..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Sys.Preview.Timer Control &#8211; A Client Side Timer" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/phaniraj/2007/03/15/sys-preview-timer-control-a-client-side-timer/" />
    <meta name="twitter:description" content="We have quite often come across&nbsp; scenarios where-in we need to execute certain client-Side code at certain intervals . What we often ended up doing is to use the&nbsp;window.setTimeOut() and the&nbsp;window.setInterval functions of IE to execute an expression at certain intervals of time . &nbsp; The Sys.Preview.Timer Provides an abstraction over these functions and makes..." />
author:
  login: phanirajuyn
  email: PhaniRaj@Microsoft.com
  display_name: Phani Raju MSFT
  first_name: ''
  last_name: ''
---
<p>We have quite often come across&nbsp; scenarios where-in we need to execute certain client-Side code at certain intervals .</p>
<p>What we often ended up doing is to use the&nbsp;<a href="http://msdn.microsoft.com/library/default.asp?url=/workshop/author/dhtml/reference/methods/settimeout.asp">window.setTimeOut()</a> and the&nbsp;<a href="http://msdn.microsoft.com/library/default.asp?url=/workshop/author/dhtml/reference/methods/setinterval.asp">window.setInterval</a> functions of IE to execute an expression </p>
<p>at certain intervals of time .</p>
<p>&nbsp;</p>
<p>The Sys.Preview.Timer Provides an abstraction over these functions and makes it easier to define Functions to be Executed at certain </p>
<p>Time Intervals.</p>
<pre class="csharpcode">&nbsp;</pre>
<p>You need to include the Script file "<font face="cali" color="#ff0000">PreviewScript.js<font color="#000000">" to&nbsp; have access to the Timer Control .</font></font></p>
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">script</span> <span class="attr">src</span><span class="kwrd">="Scripts/PreviewScript.js"</span> <span class="attr">type</span><span class="kwrd">="text/javascript"</span><span class="kwrd">&gt;&lt;/</span><span class="html">script</span><span class="kwrd">&gt;</span></pre>
<style type="text/css">.csharpcode, .csharpcode pre<br />
{<br />
	font-size: small;<br />
	color: black;<br />
	font-family: consolas, "Courier New", courier, monospace;<br />
	background-color: #ffffff;<br />
	/*white-space: pre;*/<br />
}<br />
.csharpcode pre { margin: 0em; }<br />
.csharpcode .rem { color: #008000; }<br />
.csharpcode .kwrd { color: #0000ff; }<br />
.csharpcode .str { color: #006080; }<br />
.csharpcode .op { color: #0000c0; }<br />
.csharpcode .preproc { color: #cc6633; }<br />
.csharpcode .asp { background-color: #ffff00; }<br />
.csharpcode .html { color: #800000; }<br />
.csharpcode .attr { color: #ff0000; }<br />
.csharpcode .alt<br />
{<br />
	background-color: #f4f4f4;<br />
	width: 100%;<br />
	margin: 0em;<br />
}<br />
.csharpcode .lnum { color: #606060; }<br />
</style>
<p>&nbsp;</p>
<p><strong><u>Instantiating the Timer control :</u></strong></p>
<pre class="csharpcode"><strong><span class="kwrd">var</span> clientSideTimer = <span class="kwrd">new</span> Sys.Preview.Timer();</strong></pre>
<pre class="csharpcode"><font face="Treb">By default , once instatiated , the Timer is disabled .</font></pre>
<pre class="csharpcode"><strong><u>Enable The Timer</u></strong></pre>
<pre class="csharpcode"><strong>clientSideTimer.set_enabled( <span class="kwrd">true</span> ); </strong></pre>
<pre class="csharpcode"><strong></strong>&nbsp;</pre>
<pre class="csharpcode"><u><strong>Set the Interval for the timer :</strong></u></pre>
<pre class="csharpcode">The Interval is measured in milliseconds </pre>
<pre class="csharpcode"><strong>clientSideTimer.set_interval( 1000 );</strong></pre>
<pre class="csharpcode"><strong><u>Add a function to be called at the interval</u></strong></pre>
<pre class="csharpcode">You add the function to be called at the interval by running </pre>
<pre class="csharpcode"><strong>clientSideTimer.add_tick( OnTimerTick );</strong></pre>
<pre class="csharpcode"><font face="tRE"></font>&nbsp;</pre>
<pre class="csharpcode"><font face="tRE">The Parameter "OnTimerTick" is a function that is executed at the Interval specified.</font></pre>
<pre class="csharpcode"><font face="tRE">You can add multiple Functions to be callled at the interval.</font></pre>
<pre class="csharpcode"><font face="tRE">The functions are executed at the interval in the <u>same order that they are added using add_tick</u>.</font></pre>
<pre class="csharpcode"><strong><u>Stop the Timer </u></strong></pre>
<pre class="csharpcode">Disable the Timer to stop the  Timer Entirely.</pre>
<pre class="csharpcode"><strong>clientSideTimer.set_enabled( <span class="kwrd">false</span> ); </strong></pre>
<pre class="csharpcode">Alternatively , you can stop certain functions being called by calling the "<font color="#ff0000"><strong>remove_tick</strong><font color="#000000"><strong>" </strong>Method on the Timer.</font></font></pre>
<pre class="csharpcode"><strong>clientSideTimer.remove_tick( OnTimerTick );</strong></pre>
<pre class="csharpcode">&nbsp;</pre>
<pre class="csharpcode">Check out the  Sample attached to get a view of how the control works and how you can use it .</pre>
<pre class="csharpcode"><strong><u>Whats Missing :</u></strong></pre>
<pre class="csharpcode">The main pain point I see in using the Timer Control is that <u>I cannot pass a context to the Functions called at the "Tick" event.</u></pre>
<pre class="csharpcode">The reason this happens is because ..</pre>
<blockquote><pre class="csharpcode">The Function that returns the callback to the "Tick" event passes "Sys.EventArgs.Empty"  to the callback.</pre>
</blockquote>
<pre class="csharpcode">You can customize the Script to enable the functionality of passing a context to the Timer Callback.</pre>
<pre class="csharpcode">We will discuss that in a future post .</pre>
<pre class="csharpcode">&nbsp;</pre>
<pre class="csharpcode">&nbsp;</pre>
<style type="text/css">.csharpcode, .csharpcode pre<br />
{<br />
	font-size: small;<br />
	color: black;<br />
	font-family: consolas, "Courier New", courier, monospace;<br />
	background-color: #ffffff;<br />
	/*white-space: pre;*/<br />
}<br />
.csharpcode pre { margin: 0em; }<br />
.csharpcode .rem { color: #008000; }<br />
.csharpcode .kwrd { color: #0000ff; }<br />
.csharpcode .str { color: #006080; }<br />
.csharpcode .op { color: #0000c0; }<br />
.csharpcode .preproc { color: #cc6633; }<br />
.csharpcode .asp { background-color: #ffff00; }<br />
.csharpcode .html { color: #800000; }<br />
.csharpcode .attr { color: #ff0000; }<br />
.csharpcode .alt<br />
{<br />
	background-color: #f4f4f4;<br />
	width: 100%;<br />
	margin: 0em;<br />
}<br />
.csharpcode .lnum { color: #606060; }<br />
</style>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Components.PostAttachments/00/01/88/52/99/Client%20Side%20Timer.zip" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-components-postattachments/00-01-88-52-99/Client-Side-Timer.zip">Client Side Timer.zip</a></p>
